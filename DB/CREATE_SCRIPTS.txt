create database PHARMASAAS;
use PHARMASAAS;

CREATE TABLE PRODUCTS (
CODE VARCHAR(25) PRIMARY KEY,
DESCRIPTION VARCHAR(100) NOT NULL
); 

CREATE TABLE MODULES (
CODE VARCHAR(25) PRIMARY KEY,
DESCRIPTION VARCHAR(100) NOT NULL,
PRODUCT_CODE VARCHAR(25) NOT NULL ,
FOREIGN KEY (PRODUCT_CODE) REFERENCES PRODUCTS(CODE)
);

CREATE TABLE FINITE_VALUE_TYPE (
CODE VARCHAR(10) PRIMARY KEY,
DESCRIPTION VARCHAR(25)
);
  
CREATE TABLE FINITE_VALUES (
CODE VARCHAR(10) PRIMARY KEY,
TYPE_CODE VARCHAR(10),
DESCRIPTION VARCHAR(50),
IS_DEFAULT BOOLEAN DEFAULT FALSE,
FOREIGN KEY (TYPE_CODE) REFERENCES FINITE_VALUE_TYPE(CODE) 
);

CREATE TABLE GENERATED_PKS (
TBL_NAME VARCHAR(40) PRIMARY KEY,
CURRENT_MAX LONG
);



CREATE TABLE COMPANIES (
ID INT PRIMARY KEY AUTO_INCREMENT,
COMPANY_CODE VARCHAR(10) NOT NULL UNIQUE,
COMPANY_NAME VARCHAR(50) NOT NULL UNIQUE,
ADDRESS1 VARCHAR(50),
ADDRESS2 VARCHAR(50),
ZIPCODE VARCHAR(50),
CITY VARCHAR(50),
PHONE    VARCHAR(20),
INDUSTRY_TYPE VARCHAR(10) NOT NULL,
BUSINESS_TYPE VARCHAR(10) NOT NULL,
STATE  VARCHAR(30),
COUNTRY  VARCHAR(30),
ADMIN_NAME VARCHAR(30),
NO_DIVISIONS INT,
NO_USERS INT, 
LOGO VARCHAR(50),
REGISTRATION_DATE DATETIME,
ACTIVATION_DATE DATETIME,
SERVICE_EXPIRY_DATE DATETIME,
IS_ACTIVE BOOLEAN DEFAULT TRUE ,
IS_DELETED BOOLEAN DEFAULT FALSE,
CREATED_DATE DATETIME,
LAST_UPDATED_DATE DATETIME,
CREATED_BY VARCHAR(50),
LAST_UPDATED_BY VARCHAR(50),
VERSION INT DEFAULT 1,
FOREIGN KEY (INDUSTRY_TYPE) REFERENCES FINITE_VALUES(CODE),
FOREIGN KEY (BUSINESS_TYPE) REFERENCES FINITE_VALUES(CODE)
);

CREATE TABLE ADDRESSES (
ID INT PRIMARY KEY AUTO_INCREMENT,
COMPANY_ID INT NOT NULL,
ADDRESS1 VARCHAR(100) NOT NULL,
ADDRESS2 VARCHAR(100) ,
STREET_NAME VARCHAR(100) NOT NULL,
ZIPCODE VARCHAR(100) NOT NULL,
PHONE VARCHAR(50) ,
CITY VARCHAR(50) ,
STATE VARCHAR(50) ,
COUNTRY VARCHAR(50) ,
IS_DELETED BOOLEAN DEFAULT FALSE,
CREATED_DATE DATETIME,
LAST_UPDATED_DATE DATETIME,
CREATED_BY VARCHAR(50),
LAST_UPDATED_BY VARCHAR(50),
VERSION INT DEFAULT 1,
FOREIGN KEY (COMPANY_ID) REFERENCES COMPANIES(ID)
);

CREATE TABLE ZONES (
ID INT PRIMARY KEY AUTO_INCREMENT,
COMPANY_ID INT NOT NULL,
NAME VARCHAR(50) NOT NULL ,
ZONE_TYPE VARCHAR(10) NOT NULL ,
DESCRIPTION VARCHAR(250),
IS_DELETED BOOLEAN DEFAULT FALSE,
CREATED_DATE DATETIME,
LAST_UPDATED_DATE DATETIME,
CREATED_BY VARCHAR(50),
LAST_UPDATED_BY VARCHAR(50),
VERSION INT DEFAULT 1,
FOREIGN KEY (COMPANY_ID) REFERENCES COMPANIES(ID),
FOREIGN KEY (ZONE_TYPE) REFERENCES FINITE_VALUES(CODE)
);


CREATE TABLE REGIONS (
ID INT PRIMARY KEY AUTO_INCREMENT,
COMPANY_ID INT NOT NULL,
REGION_CODE VARCHAR(10) NOT NULL ,
REGION_NAME VARCHAR(50) NOT NULL ,
REGION_HEAD VARCHAR(50) NOT NULL ,
REGION_HEAD_USER_ID VARCHAR(50),
DESCRIPTION VARCHAR(250),
IS_DELETED BOOLEAN DEFAULT FALSE,
CREATED_DATE DATETIME,
LAST_UPDATED_DATE DATETIME,
CREATED_BY VARCHAR(50),
LAST_UPDATED_BY VARCHAR(50),
VERSION INT DEFAULT 1,
FOREIGN KEY (COMPANY_ID) REFERENCES COMPANIES(ID)
);

CREATE TABLE LOCATIONS (
ID INT PRIMARY KEY AUTO_INCREMENT,
COMPANY_ID INT NOT NULL,
LOCATION_CODE VARCHAR(10) NOT NULL ,
LOCATION_NAME VARCHAR(50) NOT NULL ,
LOC_TYPE VARCHAR(10) NOT NULL ,
REGION_ID INT NOT NULL,
DESCRIPTION VARCHAR(250),
IS_DELETED BOOLEAN DEFAULT FALSE,
CREATED_DATE DATETIME,
LAST_UPDATED_DATE DATETIME,
CREATED_BY VARCHAR(50),
LAST_UPDATED_BY VARCHAR(50),
VERSION INT DEFAULT 1,
FOREIGN KEY (COMPANY_ID) REFERENCES COMPANIES(ID),
FOREIGN KEY (LOC_TYPE) REFERENCES FINITE_VALUES(CODE),
FOREIGN KEY (REGION_ID) REFERENCES REGIONS(ID)
);

CREATE TABLE DIVISIONS (
ID INT PRIMARY KEY AUTO_INCREMENT,
DIVISION_CODE VARCHAR(10) NOT NULL ,
DIVISION_NAME VARCHAR(50) NOT NULL ,
EMAIL VARCHAR(50),
ADDRESS_ID INT NOT NULL,
COMPANY_ID INT NOT NULL,
AREA  VARCHAR(20),
DIV_TYPE VARCHAR(10),
MANAGER VARCHAR(50), 
MANAGER_USER_ID VARCHAR(50), 
NO_EMPLOYEES INT,
IS_DELETED BOOLEAN DEFAULT FALSE,
CREATED_DATE DATETIME,
LAST_UPDATED_DATE DATETIME,
CREATED_BY VARCHAR(50),
LAST_UPDATED_BY VARCHAR(50),
VERSION INT DEFAULT 1,
FOREIGN KEY (COMPANY_ID) REFERENCES COMPANIES(ID),
FOREIGN KEY (DIV_TYPE) REFERENCES FINITE_VALUES(CODE),
FOREIGN KEY (ADDRESS_ID) REFERENCES ADDRESSES(ID)
);




CREATE TABLE ROLES (
ID INT PRIMARY KEY AUTO_INCREMENT,
ROLE VARCHAR(50) NOT NULL,
COMPANY_ID INT NOT NULL,
IS_DELETED BOOLEAN DEFAULT FALSE,
CREATED_DATE DATETIME,
LAST_UPDATED_DATE DATETIME,
CREATED_BY VARCHAR(50),
LAST_UPDATED_BY VARCHAR(50),
VERSION INT DEFAULT 1,
FOREIGN KEY (COMPANY_ID) REFERENCES COMPANIES(ID)
);

CREATE TABLE ROLE_MODULES (
ID INT PRIMARY KEY AUTO_INCREMENT,
ROLE_ID INT NOT NULL,
COMPANY_ID INT NOT NULL,
MODULE_CODE VARCHAR(25) NOT NULL,
ACCESS_ALLOWED BOOLEAN DEFAULT FALSE,
IS_DELETED BOOLEAN DEFAULT FALSE,
CREATED_DATE DATETIME,
LAST_UPDATED_DATE DATETIME,
CREATED_BY VARCHAR(50),
LAST_UPDATED_BY VARCHAR(50),
VERSION INT DEFAULT 1,
FOREIGN KEY (COMPANY_ID) REFERENCES COMPANIES(ID),
FOREIGN KEY (MODULE_CODE) REFERENCES MODULES(CODE)
);


CREATE TABLE USERS (
USER_ID VARCHAR(50) PRIMARY KEY,
COMPANY_ID INT,
PASSWORD VARCHAR(50) NOT NULL,
COMPANY_OWNER BOOLEAN DEFAULT FALSE, 
ROLE_ID INT,
FIRST_NAME VARCHAR(50),
LAST_NAME VARCHAR(50),
PHONE VARCHAR(50) NOT NULL UNIQUE ,
EMAIL VARCHAR(50) NOT NULL UNIQUE,
ADDRESS1 VARCHAR(50),
ADDRESS2 VARCHAR(50),
ZIPCODE VARCHAR(50),
CITY VARCHAR(50),
DIVISION_ID INT,
IS_ACTIVE BOOLEAN DEFAULT TRUE ,
IS_DELETED BOOLEAN DEFAULT FALSE,
CREATED_DATE DATETIME,
LAST_UPDATED_DATE DATETIME,
CREATED_BY VARCHAR(50),
LAST_UPDATED_BY VARCHAR(50),
VERSION INT DEFAULT 1,
FOREIGN KEY (ROLE_ID) REFERENCES ROLES(ID),
FOREIGN KEY (COMPANY_ID) REFERENCES COMPANIES(ID),
FOREIGN KEY (DIVISION_ID) REFERENCES DIVISIONS(ID)
);

CREATE TABLE LOGIN_RECORDS(
TOKEN_ID VARCHAR(50) PRIMARY KEY,
USER_ID VARCHAR(50) ,
SESSION_ID VARCHAR(50),
IS_MOBILE_LOGIN BOOLEAN DEFAULT FALSE,
MOBILE_NOTIFICATION_ID  BLOB,
LOGGED_IN_TIME DATETIME, 
LOGGED_OFF_TIME DATETIME, 
EXPIRED_TIME DATETIME,
EXTRA_PROPERTIES BLOB ,
FOREIGN KEY (USER_ID) REFERENCES USERS(USER_ID)
);

CREATE TABLE NEXTUP_CONFIG (
COMPANY_ID INT NOT NULL,
PROGRAM VARCHAR(50),
FIELD1_TYPE  VARCHAR(10),
FIELD1_WIDTH  INT,
FIELD1_VAULE  VARCHAR(10),
FIELD2_TYPE  VARCHAR(10),
FIELD2_WIDTH  INT,
FIELD2_VAULE  VARCHAR(10),
FIELD3_TYPE  VARCHAR(10),
FIELD3_WIDTH  INT,
FIELD3_VAULE  VARCHAR(10),
FIELD4_TYPE  VARCHAR(10),
FIELD4_WIDTH  INT,
FIELD4_VAULE  VARCHAR(10),
FOREIGN KEY (FIELD1_TYPE) REFERENCES FINITE_VALUES(CODE),
FOREIGN KEY (FIELD2_TYPE) REFERENCES FINITE_VALUES(CODE),
FOREIGN KEY (FIELD3_TYPE) REFERENCES FINITE_VALUES(CODE),
FOREIGN KEY (FIELD4_TYPE) REFERENCES FINITE_VALUES(CODE)
);


CREATE TABLE NEXTUP_VALUES (
COMPANY_ID INT NOT NULL,
DIVISION_ID INT NOT NULL,
PROGRAM VARCHAR(50) ,
SEQ_VALUE INT  NOT NULL
);


CREATE TABLE FILTERS (
ID INT PRIMARY KEY AUTO_INCREMENT,
COMPANY_ID INT NOT NULL,
USER_ID VARCHAR(50) NOT NULL,
PAGE VARCHAR(150)  NOT NULL,
NAME VARCHAR(50)  NOT NULL,
IS_PUBLIC BOOLEAN DEFAULT FALSE,
IS_DELETED BOOLEAN DEFAULT FALSE,
CREATED_DATE DATETIME,
LAST_UPDATED_DATE DATETIME,
CREATED_BY VARCHAR(50),
LAST_UPDATED_BY VARCHAR(50),
VERSION INT DEFAULT 1,
FOREIGN KEY (USER_ID) REFERENCES USERS(USER_ID),
FOREIGN KEY (COMPANY_ID) REFERENCES COMPANIES(ID)
);

CREATE TABLE FILTER_DETAILS(
ID INT PRIMARY KEY AUTO_INCREMENT,
FILTER_ID INT NOT NULL,
FIELD VARCHAR(50),
VALUE VARCHAR(50),
FOREIGN KEY (FILTER_ID) REFERENCES FILTERS(ID)
);


CREATE TABLE DEPARTMENTS (
ID INT PRIMARY KEY AUTO_INCREMENT,
DEPARTMENT_CODE VARCHAR(10) NOT NULL ,
DEPARTMENT_NAME VARCHAR(50) NOT NULL ,
DESCRIPTION VARCHAR(200),
COMPANY_ID INT NOT NULL,
DEPARTMENT_HEAD VARCHAR(50), 
DEPARTMENT_HEAD_USER_ID VARCHAR(50), 
NO_EMPLOYEES INT,
IS_DELETED BOOLEAN DEFAULT FALSE,
CREATED_DATE DATETIME,
LAST_UPDATED_DATE DATETIME,
CREATED_BY VARCHAR(50),
LAST_UPDATED_BY VARCHAR(50),
VERSION INT DEFAULT 1,
FOREIGN KEY (COMPANY_ID) REFERENCES COMPANIES(ID)
);


CREATE TABLE METADATA (
ENTITY VARCHAR(50) PRIMARY KEY,
CLASS_NAME VARCHAR(200),
METADATA_TYPE  VARCHAR(10),
IS_DIVISION_SPEC BOOLEAN DEFAULT FALSE,
HQL_CLASS VARCHAR(50), 
DESCRIPTION VARCHAR(50), 
DATE_FIELD VARCHAR(50), 
FOREIGN KEY (METADATA_TYPE) REFERENCES FINITE_VALUES(CODE)
);

CREATE TABLE ENTITY_FIELDS (
ENTITY VARCHAR(50) NOT NULL,
KEY_FIELD VARCHAR(50) NOT NULL,
HQL_KEY_FIELD VARCHAR(50),
DESCRIPTION VARCHAR(50), 
DATA_TYPE VARCHAR(10) NOT NULL,
FV_TYPE VARCHAR(10), 
JOIN_HQL_CLAUSE VARCHAR(150),
JOIN_HQL_CONDITION VARCHAR(150),
FOREIGN KEY (ENTITY) REFERENCES METADATA(ENTITY),
FOREIGN KEY (DATA_TYPE) REFERENCES FINITE_VALUES(CODE),
FOREIGN KEY (FV_TYPE) REFERENCES FINITE_VALUE_TYPE(CODE)
);

CREATE TABLE ENTITY_RELATIONS (
PRIMARY_ENTITY VARCHAR(50) NOT NULL,
SECONDARY_ENTITY VARCHAR(50) NOT NULL,
CARDINALITY VARCHAR(10) NOT NULL,
HQL_JOIN_CONDITION VARCHAR(150), 
DESCRIPTION VARCHAR(50), 
FOREIGN KEY (PRIMARY_ENTITY) REFERENCES METADATA(ENTITY),
FOREIGN KEY (SECONDARY_ENTITY) REFERENCES METADATA(ENTITY),
FOREIGN KEY (CARDINALITY) REFERENCES FINITE_VALUES(CODE)
);

CREATE TABLE STOCKISTS (
ID INT PRIMARY KEY AUTO_INCREMENT,
CODE VARCHAR(10) NOT NULL ,
NAME VARCHAR(50) NOT NULL ,
DESCRIPTION VARCHAR(200),
COMPANY_ID INT NOT NULL,
ADDRESS_ID INT NOT NULL,
CONTACT_PERSONAL VARCHAR(50) NOT NULL, 
CONTACT_PERSONAL_PHONE VARCHAR(50), 
EMAIL VARCHAR(50), 
IS_DELETED BOOLEAN DEFAULT FALSE,
CREATED_DATE DATETIME,
LAST_UPDATED_DATE DATETIME,
CREATED_BY VARCHAR(50),
LAST_UPDATED_BY VARCHAR(50),
VERSION INT DEFAULT 1,
FOREIGN KEY (COMPANY_ID) REFERENCES COMPANIES(ID),
FOREIGN KEY (ADDRESS_ID) REFERENCES ADDRESSES(ID)
);

CREATE TABLE STOCKISTS_ASSOCIATIONS (
ID INT PRIMARY KEY AUTO_INCREMENT,
STOCKIST_ID INT NOT NULL,
COMPANY_ID INT NOT NULL,
STATUS BOOLEAN DEFAULT FALSE,
LOCATION_ID INT ,
DESCRIPTION VARCHAR(200),
IS_DELETED BOOLEAN DEFAULT FALSE,
CREATED_DATE DATETIME,
LAST_UPDATED_DATE DATETIME,
CREATED_BY VARCHAR(50),
LAST_UPDATED_BY VARCHAR(50),
VERSION INT DEFAULT 1,
FOREIGN KEY (COMPANY_ID) REFERENCES COMPANIES(ID),
FOREIGN KEY (STOCKIST_ID) REFERENCES STOCKISTS(ID),
FOREIGN KEY (LOCATION_ID) REFERENCES LOCATIONS(ID)
);

CREATE TABLE STORES (
ID INT PRIMARY KEY AUTO_INCREMENT,
CODE VARCHAR(10) NOT NULL ,
NAME VARCHAR(50) NOT NULL ,
DESCRIPTION VARCHAR(200),
COMPANY_ID INT NOT NULL,
ADDRESS_ID INT NOT NULL,
CONTACT_PERSONAL VARCHAR(50) NOT NULL, 
CONTACT_PERSONAL_PHONE VARCHAR(50), 
EMAIL VARCHAR(50), 
IS_DELETED BOOLEAN DEFAULT FALSE,
CREATED_DATE DATETIME,
LAST_UPDATED_DATE DATETIME,
CREATED_BY VARCHAR(50),
LAST_UPDATED_BY VARCHAR(50),
VERSION INT DEFAULT 1,
FOREIGN KEY (COMPANY_ID) REFERENCES COMPANIES(ID),
FOREIGN KEY (ADDRESS_ID) REFERENCES ADDRESSES(ID)
);

CREATE TABLE STORE_ASSOCIATIONS (
ID INT PRIMARY KEY AUTO_INCREMENT,
STORE_ID INT NOT NULL,
COMPANY_ID INT NOT NULL,
STATUS BOOLEAN DEFAULT FALSE,
LOCATION_ID INT ,
DESCRIPTION VARCHAR(200),
IS_DELETED BOOLEAN DEFAULT FALSE,
CREATED_DATE DATETIME,
LAST_UPDATED_DATE DATETIME,
CREATED_BY VARCHAR(50),
LAST_UPDATED_BY VARCHAR(50),
VERSION INT DEFAULT 1,
FOREIGN KEY (COMPANY_ID) REFERENCES COMPANIES(ID),
FOREIGN KEY (STORE_ID) REFERENCES STORES(ID),
FOREIGN KEY (LOCATION_ID) REFERENCES LOCATIONS(ID)
);

CREATE TABLE DOCTORS (
ID INT PRIMARY KEY AUTO_INCREMENT,
NAME VARCHAR(50) NOT NULL ,
QUALIFICATIONS VARCHAR(100),
DESCRIPTION VARCHAR(200),
COMPANY_ID INT NOT NULL,
ADDRESS_ID INT NOT NULL,
ALTERNATE_PHONE VARCHAR(50),
SPECIALIZATION VARCHAR(10),
HOSPITAL VARCHAR(200),
EMAIL VARCHAR(50), 
IS_DELETED BOOLEAN DEFAULT FALSE,
CREATED_DATE DATETIME,
LAST_UPDATED_DATE DATETIME,
CREATED_BY VARCHAR(50),
LAST_UPDATED_BY VARCHAR(50),
VERSION INT DEFAULT 1,
FOREIGN KEY (COMPANY_ID) REFERENCES COMPANIES(ID),
FOREIGN KEY (ADDRESS_ID) REFERENCES ADDRESSES(ID),
FOREIGN KEY (SPECIALIZATION) REFERENCES FINITE_VALUES(CODE)
);

CREATE TABLE DOCTOR_ASSOCIATIONS (
ID INT PRIMARY KEY AUTO_INCREMENT,
DOCTOR_ID INT NOT NULL,
COMPANY_ID INT NOT NULL,
STATUS BOOLEAN DEFAULT FALSE,
LOCATION_ID INT ,
DESCRIPTION VARCHAR(200),
IS_DELETED BOOLEAN DEFAULT FALSE,
CREATED_DATE DATETIME,
LAST_UPDATED_DATE DATETIME,
CREATED_BY VARCHAR(50),
LAST_UPDATED_BY VARCHAR(50),
VERSION INT DEFAULT 1,
FOREIGN KEY (COMPANY_ID) REFERENCES COMPANIES(ID),
FOREIGN KEY (DOCTOR_ID) REFERENCES DOCTORS(ID),
FOREIGN KEY (LOCATION_ID) REFERENCES LOCATIONS(ID)
);
